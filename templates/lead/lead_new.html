{% load static %} {% include "home.html" %} {% block content %}

<div class="container-fluid">
  <div class="row">
    <!-- Company Details section -->
    <div class="col-lg-3 col-mb-3 bg-primary p-2 text-dark bg-opacity-10">
      <div class="container py-2">
        <!-- Insert Client's Name (Company Name and other details) -->
        <h4 class="mt-2 mb-0 text-primary-emphasis">{{company}}</h4>
        <p class="m-0 text-secondary">Gstin: {{company.gstin}}</p>
        <p class="m-0 text-capitalize text-secondary">
          {{company.address1}} {{company.address2}} {{company.city}},
          {{company.state}},({{company.pincode}}) {{company.country}}
        </p>
        <p class="m-0 fw-medium text-secondary">
          Industry: {{company.industry}}
        </p>
      </div>
      <hr />
      <!-- Contact person details of Company (client) -->
      <div class="container py-2">
        <h5 class="mt-2 mb-0">
          Contact Details {% if company.user == request.user.id %}
          <button
            class="btn btn-sm btn-outline-primary float-end"
            data-bs-toggle="modal"
            data-bs-target="#addContact"
          >
            <i class="ti ti-user-plus"></i> Add Contact
          </button>
          {% endif %}
        </h5>
        <div class="container mt-3">
          <!-- contact person Name -->
          {% for person in contact_person %}
          <h6 class="mt-2 mb-0 text-primary-emphasis">
            {{person}} {% if company.user == request.user.id %}
            <a href="" class="btn p-0 text-primary float-end" data-bs-toggle="modal" data-bs-target="#editContact{{person.id}}"
              ><i class="ti ti-edit"></i
            ></a>
            {% endif %}
            <!-- Edit button to Update details -->
          </h6>
          <!--Email and contact no inserted here-->
          <p class="m-0 text-primary-emphasis">
            <i class="ti ti-mail"></i>: {{person.email_id}}
          </p>
          <p class="m-0 text-warning-emphasis">
            <i class="ti ti-device-mobile"></i>: {{person.contact_no}}
          </p>

            <!-- Model for edit Contact Person starts here -->

            <div class="modal fade" id="editContact{{person.id}}" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
              <div class="modal-dialog">
                <div class="modal-content">
                  <div class="modal-header">
                    <h1 class="modal-title fs-5 text-primary-emphasis" id="exampleModalLabel"><i class="ti ti-clipboard-plus"></i>Edit Contact Person</h1>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                  </div>
                  <div class="modal-body">
                    <form action="{% url 'lead:edit_contact' person.id %}" method="post">
                      {% csrf_token %}
                      <div class="my-1">
                        <label for="recipient-name" class="col-form-label">Contact Person:</label>
                        <input type="text" class="form-control form-control-sm" name="contact_person" value="{{person}}">
                      </div>
                      <div class="my-1">
                        <label for="email-id" class="col-form-label">Email:</label>
                        <input type="email" class="form-control form-control-sm" id="email-id" name="email" value="{{person.email_id}}">
                      </div>
                      <div class="my-1">
                        <label for="contact-no" class="col-form-label">Contact No.:</label>
                        <input type="text" class="form-control form-control-sm" id="contact-no" name="contact_no" value="{{person.contact_no}}" >
                      </div>
                      <div class="my-1">
                        <input
                        class="form-check-input"
                        type="checkbox"
                        name="is_active"
                        {% if person.is_active %}
                        checked
                        {% endif %}
                      />
                      <label class="form-check-label form-check-label-sm" for="contactNo">Is Active</label>
                      </div>
                      <div class="modal-footer">
                        <button type="submit" class="btn btn-sm btn-primary">Update Contact</button>
                        <button type="button" class="btn btn-sm btn-secondary" data-bs-dismiss="modal">Close</button>
                      </div>
                    </form>
                  </div>
                </div>
              </div>
            </div>
          
            <!-- Model for edit Contact Person end here -->

          {%endfor%}
        </div>
      </div>
    </div>
    <!-- Company details Section ended here -->
    
    <!-- Model for New Contact Person start here -->
    
    <div class="modal fade" id="addContact" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h1 class="modal-title fs-5" id="exampleModalLabel"><i class="ti ti-clipboard-plus"></i>Add Contact Person</h1>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <form action="{% url 'lead:add_contact' company.id %}" method="post">
              {% csrf_token %}
              <div class="my-1">
                <label for="recipient-name" class="col-form-label">Contact Person:</label>
                <input type="text" class="form-control form-control-sm" name="contact_person">
              </div>
              <div class="my-1">
                <label for="email-id" class="col-form-label">Email:</label>
                <input type="email" class="form-control form-control-sm" id="email-id" name="email" >
              </div>
              <div class="my-1">
                <label for="contact-no" class="col-form-label">Contact No.:</label>
                <input type="text" class="form-control form-control-sm" id="contact-no" name="contact_no" >
              </div>
              <div class="my-1">
                <input
                class="form-check-input"
                type="checkbox"
                name="is_active"
                checked
              />
              <label class="form-check-label" for="contactNo">Is Active</label>
              </div>
              <div class="modal-footer">
                <button type="submit" class="btn btn-sm btn-primary">Add Contact</button>
                <button type="button" class="btn btn-sm btn-secondary" data-bs-dismiss="modal">Close</button>
              </div>
            </form>
          </div>
        </div>
      </div>
    </div>

    <!-- Model for New Contact Person end here -->

    <!-- Company's Activity and chat details and PI list section -->
    
    <div class="col-lg-9 col-mb-9 pt-3 bg-body-tertiary">
      <nav class="nav">
        <a
          class="btn btn-outline-primary mx-2 nav2-item"
          href="{% url 'lead:leads_pi' company.id %}"
          >Proforma Invoice</a
        >
        <a
          class="btn btn-outline-primary mx-2 nav2-item"
          href="{% url 'lead:leads_chat' company.id %}"
          >Chat</a
        >
        <a class="btn btn-outline-secondary mx-2 disabled" href="#">Disabled</a>
      </nav>
      <hr />
      {% block leadContent %}{% endblock leadContent %}
    </div>
  </div>
</div>

{% endblock %}
